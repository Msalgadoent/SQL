--In this SQL code, I'm querying a database which represents a digital media store and includes tables for artists, albums, media tracks, invoices, and customers.

#1 What is the total revenue from all sales?

SELECT SUM(Total) 
FROM invoices;

#2 What is the most popular genre by the number of tracks?

SELECT g.Name, COUNT(*) AS track_count
FROM genres g
JOIN tracks t ON g.GenreId = t.GenreId
GROUP BY g.Name
ORDER BY track_count DESC
LIMIT 1;

#3 Who are the top 5 best-selling artists?

SELECT ar.Name, SUM(ii.Quantity) AS total_sales
FROM artists ar
JOIN albums al ON ar.ArtistId = al.ArtistId
JOIN tracks t ON al.AlbumId = t.AlbumId
JOIN invoice_items ii ON t.TrackId = ii.TrackId
GROUP BY ar.Name
ORDER BY total_sales DESC
LIMIT 5;

#4 What are the top 5 countries by revenue?

SELECT i.BillingCountry, SUM(i.Total) AS revenue
FROM invoices i
GROUP BY i.BillingCountry
ORDER BY revenue DESC
LIMIT 5;

#5 What is the most popular media type by the number of tracks?

SELECT mt.Name, COUNT(*) AS track_count
FROM media_types mt
JOIN tracks t ON mt.MediaTypeId = t.MediaTypeId
GROUP BY mt.Name
ORDER BY track_count DESC
LIMIT 1;

#6 What is the total revenue generated by each support representative?

SELECT e.FirstName, e.LastName, SUM(i.Total) AS total_revenue
FROM employees e
JOIN customers c ON e.EmployeeId = c.SupportRepId
JOIN invoices i ON c.CustomerId = i.CustomerId
GROUP BY e.EmployeeId
ORDER BY total_revenue DESC;



